<!DOCTYPE HTML>
<html lang="vi" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>The Abstraction: The Process - OS BÃ­ truyá»n thÆ° - OSTEP in Vietnamese</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../index.html"><strong aria-hidden="true">1.</strong> Trang chá»§</a></li><li class="chapter-item expanded affix "><li class="part-title">Pháº§n 1: Virtualization</li><li class="chapter-item expanded "><a href="../02/index.html"><strong aria-hidden="true">2.</strong> Introduction to Operating Systems</a></li><li class="chapter-item expanded "><a href="../03/index.html"><strong aria-hidden="true">3.</strong> A Dialogue on Virtualization</a></li><li class="chapter-item expanded "><a href="../04/index.html" class="active"><strong aria-hidden="true">4.</strong> The Abstraction: The Process</a></li><li class="chapter-item expanded "><a href="../05/index.html"><strong aria-hidden="true">5.</strong> Interlude: Process API</a></li><li class="chapter-item expanded "><a href="../06/index.html"><strong aria-hidden="true">6.</strong> Mechanism: Limited Direct Execution</a></li><li class="chapter-item expanded "><a href="../07/index.html"><strong aria-hidden="true">7.</strong> Scheduling: Introduction</a></li><li class="chapter-item expanded "><a href="../08/index.html"><strong aria-hidden="true">8.</strong> Scheduling:The Multi-Level Feedback Queue</a></li><li class="chapter-item expanded "><a href="../09/index.html"><strong aria-hidden="true">9.</strong> Scheduling: Proportional Share</a></li><li class="chapter-item expanded "><a href="../10/index.html"><strong aria-hidden="true">10.</strong> Multiprocessor Scheduling (Advanced)</a></li><li class="chapter-item expanded "><a href="../13/index.html"><strong aria-hidden="true">11.</strong> The Abstraction: Address Spaces</a></li><li class="chapter-item expanded "><a href="../14/index.html"><strong aria-hidden="true">12.</strong> Interlude: Memory API</a></li><li class="chapter-item expanded "><a href="../15/index.html"><strong aria-hidden="true">13.</strong> Mechanism: Address Translation</a></li><li class="chapter-item expanded "><a href="../16/index.html"><strong aria-hidden="true">14.</strong> Segmentation</a></li><li class="chapter-item expanded "><a href="../17/index.html"><strong aria-hidden="true">15.</strong> Free-Space Management</a></li><li class="chapter-item expanded "><a href="../18/index.html"><strong aria-hidden="true">16.</strong> Paging: Introduction</a></li><li class="chapter-item expanded "><a href="../19/index.html"><strong aria-hidden="true">17.</strong> Paging: Faster Translations (TLBs)</a></li><li class="chapter-item expanded "><a href="../20/index.html"><strong aria-hidden="true">18.</strong> Paging: Smaller Tables</a></li><li class="chapter-item expanded "><a href="../21/index.html"><strong aria-hidden="true">19.</strong> Beyond Physical Memory: Mechanisms</a></li><li class="chapter-item expanded "><a href="../22/index.html"><strong aria-hidden="true">20.</strong> Beyond Physical Memory: Policies</a></li><li class="chapter-item expanded "><a href="../23/index.html"><strong aria-hidden="true">21.</strong> The VAX/VMS Virtual Memory System</a></li><li class="chapter-item expanded affix "><li class="part-title">Pháº§n 2: Concurrency</li><li class="chapter-item expanded "><a href="../26/index.html"><strong aria-hidden="true">22.</strong> Concurrency: An Introduction</a></li><li class="chapter-item expanded "><a href="../27/index.html"><strong aria-hidden="true">23.</strong> Interlude: Thread API</a></li><li class="chapter-item expanded "><a href="../28/index.html"><strong aria-hidden="true">24.</strong> Locks</a></li><li class="chapter-item expanded "><a href="../29/index.html"><strong aria-hidden="true">25.</strong> Lock-based Concurrent Data Structures</a></li><li class="chapter-item expanded "><a href="../30/index.html"><strong aria-hidden="true">26.</strong> Condition Variables</a></li><li class="chapter-item expanded "><a href="../31/index.html"><strong aria-hidden="true">27.</strong> Semaphores</a></li><li class="chapter-item expanded "><a href="../32/index.html"><strong aria-hidden="true">28.</strong> Common Concurrency Problems</a></li><li class="chapter-item expanded "><a href="../33/index.html"><strong aria-hidden="true">29.</strong> Event-based Concurrency (Advanced)</a></li><li class="chapter-item expanded affix "><li class="part-title">Pháº§n 3 Persistence</li><li class="chapter-item expanded "><a href="../36/index.html"><strong aria-hidden="true">30.</strong> I/O Devices</a></li><li class="chapter-item expanded "><a href="../37/index.html"><strong aria-hidden="true">31.</strong> Hard Disk Drives</a></li><li class="chapter-item expanded "><a href="../38/index.html"><strong aria-hidden="true">32.</strong> Redundant Arrays of Inexpensive Disks (RAIDs)</a></li><li class="chapter-item expanded "><a href="../39/index.html"><strong aria-hidden="true">33.</strong> Interlude: Files and Directories</a></li><li class="chapter-item expanded "><a href="../40/index.html"><strong aria-hidden="true">34.</strong> File System Implementation</a></li><li class="chapter-item expanded "><a href="../41/index.html"><strong aria-hidden="true">35.</strong> Locality and The Fast File System</a></li><li class="chapter-item expanded "><a href="../42/index.html"><strong aria-hidden="true">36.</strong> Crash Consistency: FSCK and Journaling</a></li><li class="chapter-item expanded "><a href="../43/index.html"><strong aria-hidden="true">37.</strong> Log-structured File Systems</a></li><li class="chapter-item expanded "><a href="../44/index.html"><strong aria-hidden="true">38.</strong> Flash-based SSDs</a></li><li class="chapter-item expanded "><a href="../45/index.html"><strong aria-hidden="true">39.</strong> Data Integrity and Protection</a></li><li class="chapter-item expanded "><a href="../48/index.html"><strong aria-hidden="true">40.</strong> Distributed Systems</a></li><li class="chapter-item expanded "><a href="../49/index.html"><strong aria-hidden="true">41.</strong> Sunâ€™s Network File System (NFS)</a></li><li class="chapter-item expanded "><a href="../50/index.html"><strong aria-hidden="true">42.</strong> The Andrew File System (AFS)</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">OS BÃ­ truyá»n thÆ° - OSTEP in Vietnamese</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="4-sá»±-trá»«u-tÆ°á»£ng-process-tiáº¿n-trÃ¬nh"><a class="header" href="#4-sá»±-trá»«u-tÆ°á»£ng-process-tiáº¿n-trÃ¬nh">4. Sá»± trá»«u tÆ°á»£ng: Process (tiáº¿n trÃ¬nh)</a></h1>
<p>Trong chÆ°Æ¡ng nÃ y, chÃºng ta sáº½ tháº£o luáº­n vá» má»™t trong nhá»¯ng <strong>sá»± trá»«u tÆ°á»£ng (abstraction)</strong> cÆ¡ báº£n nháº¥t mÃ  há»‡ Ä‘iá»u hÃ nh cung cáº¥p cho ngÆ°á»i dÃ¹ng: <strong>process (tiáº¿n trÃ¬nh)</strong>.</p>
<p>Má»™t Ä‘á»‹nh nghÄ©a khÃ´ng chÃ­nh thá»©c vá» process khÃ¡ Ä‘Æ¡n giáº£n: Ä‘Ã³ lÃ  má»™t <strong>chÆ°Æ¡ng trÃ¬nh Ä‘ang cháº¡y</strong> [V+65, BH70]. Báº£n thÃ¢n chÆ°Æ¡ng trÃ¬nh khi náº±m trÃªn Ä‘Ä©a chá»‰ lÃ  má»™t thá»±c thá»ƒ â€œvÃ´ há»“nâ€: má»™t táº­p há»£p cÃ¡c lá»‡nh (vÃ  cÃ³ thá»ƒ lÃ  static data (dá»¯ liá»‡u tÄ©nh)), chá» Ä‘Æ°á»£c kÃ­ch hoáº¡t. ChÃ­nh há»‡ Ä‘iá»u hÃ nh lÃ  thÃ nh pháº§n láº¥y nhá»¯ng byte Ä‘Ã³, cho chÃºng cháº¡y, vÃ  biáº¿n chÆ°Æ¡ng trÃ¬nh thÃ nh má»™t thá»±c thá»ƒ há»¯u Ã­ch.</p>
<p>Thá»±c táº¿, ngÆ°á»i dÃ¹ng thÆ°á»ng muá»‘n cháº¡y nhiá»u chÆ°Æ¡ng trÃ¬nh cÃ¹ng lÃºc; vÃ­ dá»¥, trÃªn mÃ¡y tÃ­nh Ä‘á»ƒ bÃ n hoáº·c laptop, báº¡n cÃ³ thá»ƒ cháº¡y trÃ¬nh duyá»‡t web, chÆ°Æ¡ng trÃ¬nh email, má»™t trÃ² chÆ¡i, má»™t trÃ¬nh phÃ¡t nháº¡c,... Tháº­m chÃ­, má»™t há»‡ thá»‘ng Ä‘iá»ƒn hÃ¬nh cÃ³ thá»ƒ cháº¡y hÃ ng chá»¥c hoáº·c hÃ ng trÄƒm process Ä‘á»“ng thá»i. Äiá»u nÃ y lÃ m há»‡ thá»‘ng trá»Ÿ nÃªn dá»… sá»­ dá»¥ng, vÃ¬ ngÆ°á»i dÃ¹ng khÃ´ng cáº§n báº­n tÃ¢m xem CPU cÃ³ Ä‘ang ráº£nh hay khÃ´ng; Ä‘Æ¡n giáº£n chá»‰ lÃ  â€œcháº¡y chÆ°Æ¡ng trÃ¬nhâ€. Tá»« Ä‘Ã¢y, náº£y sinh má»™t thÃ¡ch thá»©c:</p>
<blockquote>
<p><strong>Váº¤N Äá»€ Cá»T LÃ•I: LÃ€M THáº¾ NÃ€O Äá»‚ Táº O RA áº¢O GIÃC Vá»€ NHIá»€U CPU?</strong></p>
<p>Trong khi thá»±c táº¿ chá»‰ cÃ³ vÃ i CPU váº­t lÃ½, lÃ m tháº¿ nÃ o há»‡ Ä‘iá»u hÃ nh cÃ³ thá»ƒ táº¡o ra áº£o giÃ¡c ráº±ng cÃ³ má»™t nguá»“n CPU gáº§n nhÆ° vÃ´ háº¡n?</p>
</blockquote>
<p>Há»‡ Ä‘iá»u hÃ nh giáº£i quyáº¿t báº±ng cÃ¡ch <strong>áº£o hÃ³a CPU (virtualizing the CPU)</strong>. Báº±ng cÃ¡ch cháº¡y má»™t process, rá»“i dá»«ng nÃ³ Ä‘á»ƒ cháº¡y process khÃ¡c, vÃ  láº·p láº¡i, há»‡ Ä‘iá»u hÃ nh táº¡o ra áº£o giÃ¡c ráº±ng cÃ³ nhiá»u CPU áº£o tá»“n táº¡i, trong khi thá»±c táº¿ chá»‰ cÃ³ má»™t (hoáº·c má»™t vÃ i) CPU váº­t lÃ½. Ká»¹ thuáº­t cÆ¡ báº£n nÃ y gá»i lÃ  <strong>time sharing (chia sáº» theo thá»i gian)</strong> CPU. Nhá» Ä‘Ã³, ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ cháº¡y nhiá»u process Ä‘á»“ng thá»i; chi phÃ­ pháº£i tráº£ lÃ  hiá»‡u nÄƒng, vÃ¬ má»—i process sáº½ cháº¡y cháº­m hÆ¡n khi CPU pháº£i Ä‘Æ°á»£c chia sáº».</p>
<p>Äá»ƒ hiá»‡n thá»±c hÃ³a áº£o hÃ³a CPU má»™t cÃ¡ch hiá»‡u quáº£, há»‡ Ä‘iá»u hÃ nh cáº§n cáº£ <strong>cÆ¡ cháº¿ (mechanism)</strong> á»Ÿ má»©c tháº¥p láº«n <strong>policy</strong> (chÃ­nh sÃ¡ch) á»Ÿ má»©c cao.</p>
<p><strong>Mechanism (cÆ¡ cháº¿)</strong>: cÃ¡c phÆ°Æ¡ng phÃ¡p hoáº·c giao thá»©c má»©c tháº¥p Ä‘á»ƒ hiá»‡n thá»±c má»™t chá»©c nÄƒng cáº§n thiáº¿t. VÃ­ dá»¥: ta sáº½ há»c vá» <strong>context switch (chuyá»ƒn ngá»¯ cáº£nh)</strong> â€” cÆ¡ cháº¿ cho phÃ©p OS dá»«ng má»™t chÆ°Æ¡ng trÃ¬nh vÃ  báº¯t Ä‘áº§u cháº¡y chÆ°Æ¡ng trÃ¬nh khÃ¡c trÃªn CPU. ÄÃ¢y lÃ  cÆ¡ cháº¿ time sharing mÃ  má»i há»‡ Ä‘iá»u hÃ nh hiá»‡n Ä‘áº¡i Ä‘á»u sá»­ dá»¥ng.</p>
<blockquote>
<p>ğŸ’¡ <strong>TIP: Sá»­ dá»¥ng Time Sharing vÃ  Space Sharing</strong></p>
<p>Time sharing lÃ  ká»¹ thuáº­t cÆ¡ báº£n giÃºp há»‡ Ä‘iá»u hÃ nh chia sáº» má»™t tÃ i nguyÃªn. TÃ i nguyÃªn (vÃ­ dá»¥ CPU hoáº·c Ä‘Æ°á»ng truyá»n máº¡ng) Ä‘Æ°á»£c cho má»™t Ä‘á»‘i tÆ°á»£ng sá»­ dá»¥ng má»™t thá»i gian ngáº¯n, sau Ä‘Ã³ Ä‘áº¿n Ä‘á»‘i tÆ°á»£ng khÃ¡c, luÃ¢n phiÃªn nhÆ° váº­y.</p>
<p>NgÆ°á»£c láº¡i, <strong>space sharing (chia sáº» theo khÃ´ng gian)</strong> chia tÃ i nguyÃªn theo â€œkhÃ´ng gianâ€. VÃ­ dá»¥, dung lÆ°á»£ng Ä‘Ä©a lÃ  má»™t tÃ i nguyÃªn space-shared: khi má»™t block Ä‘Ã£ Ä‘Æ°á»£c gÃ¡n cho má»™t file, nÃ³ sáº½ khÃ´ng Ä‘Æ°á»£c gÃ¡n cho file khÃ¡c cho Ä‘áº¿n khi ngÆ°á»i dÃ¹ng xÃ³a file ban Ä‘áº§u.</p>
</blockquote>
<p><strong>Policy</strong>: lÃ  cÃ¡c thuáº­t toÃ¡n Ä‘Æ°a ra quyáº¿t Ä‘á»‹nh trong há»‡ Ä‘iá»u hÃ nh. VÃ­ dá»¥: khi cÃ³ nhiá»u chÆ°Æ¡ng trÃ¬nh sáºµn sÃ ng cháº¡y trÃªn CPU, OS cáº§n quyáº¿t Ä‘á»‹nh cháº¡y chÆ°Æ¡ng trÃ¬nh nÃ o. <strong>Scheduling policy (chÃ­nh sÃ¡ch láº­p lá»‹ch)</strong> sáº½ Ä‘Æ°a ra quyáº¿t Ä‘á»‹nh nÃ y, thÆ°á»ng dá»±a trÃªn thÃ´ng tin lá»‹ch sá»­ (vÃ­ dá»¥: chÆ°Æ¡ng trÃ¬nh nÃ o Ä‘Ã£ cháº¡y nhiá»u hÆ¡n trong phÃºt vá»«a qua?), Ä‘áº·c Ä‘iá»ƒm workload (loáº¡i chÆ°Æ¡ng trÃ¬nh Ä‘ang cháº¡y), vÃ  tiÃªu chÃ­ hiá»‡u nÄƒng (tá»‘i Æ°u cho tÃ­nh tÆ°Æ¡ng tÃ¡c hay cho thÃ´ng lÆ°á»£ng?).</p>
<h2 id="41-sá»±-trá»«u-tÆ°á»£ng-process"><a class="header" href="#41-sá»±-trá»«u-tÆ°á»£ng-process">4.1 Sá»± trá»«u tÆ°á»£ng: Process</a></h2>
<p>Sá»± trá»«u tÆ°á»£ng mÃ  há»‡ Ä‘iá»u hÃ nh cung cáº¥p cho má»™t chÆ°Æ¡ng trÃ¬nh Ä‘ang cháº¡y chÃ­nh lÃ  <strong>process</strong>. NhÆ° Ä‘Ã£ nÃ³i á»Ÿ trÃªn, process Ä‘Æ¡n giáº£n lÃ  má»™t chÆ°Æ¡ng trÃ¬nh Ä‘ang excecute. Táº¡i má»™t thá»i Ä‘iá»ƒm báº¥t ká»³, ta cÃ³ thá»ƒ mÃ´ táº£ process báº±ng cÃ¡ch liá»‡t kÃª nhá»¯ng thÃ nh pháº§n há»‡ thá»‘ng mÃ  nÃ³ truy cáº­p hoáº·c áº£nh hÆ°á»Ÿng trong suá»‘t quÃ¡ trÃ¬nh cháº¡y.</p>
<p>Äá»ƒ hiá»ƒu process gá»“m nhá»¯ng gÃ¬, ta cáº§n hiá»ƒu <strong>machine state (tráº¡ng thÃ¡i mÃ¡y)</strong>: tá»©c lÃ  táº­p há»£p cÃ¡c giÃ¡ trá»‹ mÃ  chÆ°Æ¡ng trÃ¬nh cÃ³ thá»ƒ Ä‘á»c hoáº·c ghi trong khi excecute. Váº­y, táº¡i má»™t thá»i Ä‘iá»ƒm báº¥t ká»³, nhá»¯ng pháº§n nÃ o cá»§a mÃ¡y tÃ­nh quan trá»ng Ä‘á»‘i vá»›i viá»‡c cháº¡y chÆ°Æ¡ng trÃ¬nh?</p>
<p><strong>Memory (bá»™ nhá»›)</strong>: thÃ nh pháº§n rÃµ rÃ ng nháº¥t. CÃ¡c lá»‡nh cá»§a chÆ°Æ¡ng trÃ¬nh náº±m trong bá»™ nhá»›; dá»¯ liá»‡u mÃ  chÆ°Æ¡ng trÃ¬nh Ä‘á»c vÃ  ghi cÅ©ng náº±m trong bá»™ nhá»›. VÃ¬ váº­y, vÃ¹ng bá»™ nhá»› mÃ  process cÃ³ thá»ƒ truy cáº­p (gá»i lÃ  <strong>address space â€“ khÃ´ng gian Ä‘á»‹a chá»‰</strong>) lÃ  má»™t pháº§n cá»§a process.</p>
<p><strong>Registers (thanh ghi)</strong>: nhiá»u lá»‡nh cá»§a CPU trá»±c tiáº¿p Ä‘á»c/ghi cÃ¡c thanh ghi, nÃªn chÃºng cÅ©ng lÃ  thÃ nh pháº§n cá»‘t lÃµi cá»§a machine state. Äáº·c biá»‡t cÃ³ má»™t sá»‘ thanh ghi quan trá»ng bao gá»“m <strong>Program Counter (PC)</strong>, cÃ²n gá»i lÃ  <strong>Instruction Pointer (IP)</strong>, cho biáº¿t lá»‡nh tiáº¿p theo cáº§n excecute. Äá»“ng thá»i, cÃ²n cÃ³ <strong>Stack Pointer</strong> vÃ  <strong>Frame Pointer</strong> Ä‘i kÃ¨m Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ quáº£n lÃ½ <strong>stack</strong> (ngÄƒn xáº¿p), nÆ¡i lÆ°u tham sá»‘ hÃ m (function parameters), biáº¿n cá»¥c bá»™ (local variables) vÃ  Ä‘á»‹a chá»‰ tráº£ vá» (return addresses).</p>
<p><strong>I/O state (tráº¡ng thÃ¡i nháº­p/xuáº¥t)</strong>: chÆ°Æ¡ng trÃ¬nh thÆ°á»ng truy cáº­p cáº£ cÃ¡c thiáº¿t bá»‹ lÆ°u trá»¯ lÃ¢u dÃ i. VÃ­ dá»¥: process cÃ³ thá»ƒ duy trÃ¬ danh sÃ¡ch cÃ¡c file Ä‘ang má»Ÿ.</p>
<blockquote>
<p><strong>TIP: TÃ¡ch biá»‡t Policy vÃ  Mechanism</strong></p>
<p>Trong nhiá»u há»‡ Ä‘iá»u hÃ nh, nguyÃªn lÃ½ thiáº¿t káº¿ phá»• biáº¿n lÃ  <strong>tÃ¡ch biá»‡t policy vÃ  mechanism</strong> [L+75].</p>
<ul>
<li>
<p><strong>Mechanism</strong> tráº£ lá»i cÃ¢u há»i â€œlÃ m tháº¿ nÃ oâ€ (<em>how</em>). VÃ­ dá»¥: lÃ m tháº¿ nÃ o Ä‘á»ƒ OS thá»±c hiá»‡n context switch?</p>
</li>
<li>
<p><strong>Policy</strong> tráº£ lá»i cÃ¢u há»i â€œchá»n cÃ¡i nÃ oâ€ (<em>which</em>). VÃ­ dá»¥: OS nÃªn cháº¡y process nÃ o ngay lÃºc nÃ y?</p>
<p>Viá»‡c tÃ¡ch rá»i nÃ y cho phÃ©p thay Ä‘á»•i policy dá»… dÃ ng mÃ  khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÆ¡ cháº¿, vÃ  Ä‘Ã¢y cÅ©ng lÃ  má»™t dáº¡ng <strong>modularity (tÃ­nh mÃ´-Ä‘un)</strong> â€” nguyÃªn táº¯c chung trong thiáº¿t káº¿ pháº§n má»m.</p>
</li>
</ul>
</blockquote>
<h2 id="42-api-cá»§a-process-tiáº¿n-trÃ¬nh"><a class="header" href="#42-api-cá»§a-process-tiáº¿n-trÃ¬nh">4.2 API cá»§a Process (Tiáº¿n trÃ¬nh)</a></h2>
<p>Máº·c dÃ¹ chÃºng ta sáº½ hoÃ£n viá»‡c bÃ n chi tiáº¿t vá» má»™t API process thá»±c sá»± cho Ä‘áº¿n cÃ¡c chÆ°Æ¡ng sau, nhÆ°ng trÆ°á»›c háº¿t, á»Ÿ Ä‘Ã¢y ta sáº½ phÃ¡c tháº£o nhá»¯ng thÃ nh pháº§n cÆ¡ báº£n cáº§n cÃ³ trong báº¥t ká»³ interface (giao diá»‡n) nÃ o cá»§a há»‡ Ä‘iá»u hÃ nh. CÃ¡c API nÃ y, dÆ°á»›i má»™t dáº¡ng nÃ o Ä‘Ã³, Ä‘á»u cÃ³ máº·t trong má»i há»‡ Ä‘iá»u hÃ nh hiá»‡n Ä‘áº¡i.</p>
<ul>
<li><strong>Create (Táº¡o):</strong> Há»‡ Ä‘iá»u hÃ nh pháº£i cung cáº¥p phÆ°Æ¡ng thá»©c Ä‘á»ƒ táº¡o process má»›i. Khi báº¡n gÃµ má»™t lá»‡nh trong shell, hoáº·c nháº¥p Ä‘Ãºp vÃ o biá»ƒu tÆ°á»£ng á»©ng dá»¥ng, há»‡ Ä‘iá»u hÃ nh sáº½ Ä‘Æ°á»£c gá»i Ä‘á»ƒ táº¡o ra má»™t process má»›i nháº±m cháº¡y chÆ°Æ¡ng trÃ¬nh báº¡n yÃªu cáº§u.</li>
<li><strong>Destroy (Há»§y):</strong> CÅ©ng nhÆ° viá»‡c táº¡o process, há»‡ Ä‘iá»u hÃ nh pháº£i cung cáº¥p interface Ä‘á»ƒ há»§y process má»™t cÃ¡ch cÆ°á»¡ng bá»©c. Táº¥t nhiÃªn, nhiá»u process sáº½ tá»± cháº¡y vÃ  thoÃ¡t khi hoÃ n táº¥t; tuy nhiÃªn, khi chÃºng khÃ´ng lÃ m váº­y, ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ muá»‘n â€œkillâ€ (dá»«ng) chÃºng, vÃ  do Ä‘Ã³, interface Ä‘á»ƒ káº¿t thÃºc má»™t process â€œcháº¡y máº¥t kiá»ƒm soÃ¡tâ€ lÃ  ráº¥t há»¯u Ã­ch.</li>
<li><strong>Wait (Chá»):</strong> ÄÃ´i khi, ngÆ°á»i dÃ¹ng cáº§n chá» cho Ä‘áº¿n khi má»™t process káº¿t thÃºc; do Ä‘Ã³, háº§u háº¿t há»‡ Ä‘iá»u hÃ nh Ä‘á»u cung cáº¥p má»™t interface chá» process.</li>
<li><strong>Miscellaneous Control (CÃ¡c Ä‘iá»u khiá»ƒn khÃ¡c):</strong> NgoÃ i viá»‡c há»§y hoáº·c chá» process, há»‡ Ä‘iá»u hÃ nh cÃ²n cung cáº¥p thÃªm cÃ¡c Ä‘iá»u khiá»ƒn khÃ¡c. VÃ­ dá»¥, háº§u háº¿t há»‡ Ä‘iá»u hÃ nh cho phÃ©p táº¡m dá»«ng (suspend) má»™t process vÃ  sau Ä‘Ã³ khÃ´i phá»¥c (resume) nÃ³ Ä‘á»ƒ tiáº¿p tá»¥c cháº¡y.</li>
<li><strong>Status (Tráº¡ng thÃ¡i):</strong> ThÆ°á»ng cÃ³ cÃ¡c interface Ä‘á»ƒ láº¥y thÃ´ng tin tráº¡ng thÃ¡i cá»§a process, cháº³ng háº¡n nhÆ° process Ä‘Ã£ cháº¡y bao lÃ¢u hoáº·c hiá»‡n táº¡i Ä‘ang á»Ÿ tráº¡ng thÃ¡i nÃ o.</li>
</ul>
<p><img src="./img/fig4_1.PNG" alt="" /></p>
<p><strong>HÃ¬nh 4.1: QuÃ¡ trÃ¬nh load â€“ Tá»« ChÆ°Æ¡ng trÃ¬nh thÃ nh Process</strong></p>
<h2 id="43-táº¡o-process-chi-tiáº¿t-hÆ¡n-má»™t-chÃºt"><a class="header" href="#43-táº¡o-process-chi-tiáº¿t-hÆ¡n-má»™t-chÃºt">4.3 Táº¡o Process: Chi tiáº¿t hÆ¡n má»™t chÃºt</a></h2>
<p>Má»™t Ä‘iá»u bÃ­ áº©n mÃ  ta cáº§n lÃ m rÃµ lÃ : lÃ m tháº¿ nÃ o chÆ°Æ¡ng trÃ¬nh (program) Ä‘Æ°á»£c biáº¿n thÃ nh process? Cá»¥ thá»ƒ hÆ¡n, há»‡ Ä‘iá»u hÃ nh lÃ m tháº¿ nÃ o Ä‘á»ƒ khá»Ÿi cháº¡y má»™t chÆ°Æ¡ng trÃ¬nh? QuÃ¡ trÃ¬nh táº¡o process thá»±c sá»± diá»…n ra nhÆ° tháº¿ nÃ o?</p>
<p>BÆ°á»›c Ä‘áº§u tiÃªn mÃ  há»‡ Ä‘iá»u hÃ nh pháº£i thá»±c hiá»‡n lÃ  <strong>load mÃ£ lá»‡nh (code)</strong> vÃ  static data (vÃ­ dá»¥: cÃ¡c biáº¿n Ä‘Ã£ khá»Ÿi táº¡o) cá»§a chÆ°Æ¡ng trÃ¬nh vÃ o bá»™ nhá»›, trong <em>khÃ´ng gian Ä‘á»‹a chá»‰</em> (address space) cá»§a process. Ban Ä‘áº§u, chÆ°Æ¡ng trÃ¬nh náº±m trÃªn Ä‘Ä©a (hoáº·c, trong nhiá»u há»‡ thá»‘ng hiá»‡n Ä‘áº¡i, á»• SSD dáº¡ng flash) dÆ°á»›i má»™t Ä‘á»‹nh dáº¡ng excecute. Do Ä‘Ã³, viá»‡c load chÆ°Æ¡ng trÃ¬nh vÃ  static data vÃ o bá»™ nhá»› Ä‘Ã²i há»i há»‡ Ä‘iá»u hÃ nh pháº£i Ä‘á»c cÃ¡c byte tá»« Ä‘Ä©a vÃ  Ä‘áº·t chÃºng vÃ o má»™t vá»‹ trÃ­ nÃ o Ä‘Ã³ trong bá»™ nhá»› (nhÆ° minh há»a trong HÃ¬nh 4.1).</p>
<p>Trong cÃ¡c há»‡ Ä‘iá»u hÃ nh Ä‘Æ¡n giáº£n (hoáº·c Ä‘á»i Ä‘áº§u), quÃ¡ trÃ¬nh load thÆ°á»ng Ä‘Æ°á»£c thá»±c hiá»‡n <strong>eagerly</strong> (tá»©c lÃ  load toÃ n bá»™ trÆ°á»›c khi cháº¡y). NgÆ°á»£c láº¡i, cÃ¡c há»‡ Ä‘iá»u hÃ nh hiá»‡n Ä‘áº¡i Ã¡p dá»¥ng cÃ¡ch <strong>lazy loading</strong> (load tá»«ng pháº§n mÃ£ hoáº·c dá»¯ liá»‡u chá»‰ khi cáº§n trong quÃ¡ trÃ¬nh excecute). Äá»ƒ hiá»ƒu rÃµ lazy loading hoáº¡t Ä‘á»™ng tháº¿ nÃ o, chÃºng ta cáº§n náº¯m vá»¯ng cÃ¡c cÆ¡ cháº¿ nhÆ° <em>paging</em> (trang bá»™ nhá»›) vÃ  <em>swapping</em> (hoÃ¡n Ä‘á»•i), sáº½ Ä‘Æ°á»£c bÃ n ká»¹ hÆ¡n trong pháº§n áº£o hÃ³a bá»™ nhá»›. Táº¡m thá»i, báº¡n chá»‰ cáº§n nhá»› ráº±ng trÆ°á»›c khi cháº¡y báº¥t cá»© thá»© gÃ¬, há»‡ Ä‘iá»u hÃ nh pháº£i lÃ m cÃ´ng viá»‡c chuáº©n bá»‹: Ä‘Æ°a cÃ¡c pháº§n quan trá»ng cá»§a chÆ°Æ¡ng trÃ¬nh tá»« Ä‘Ä©a vÃ o bá»™ nhá»›.</p>
<p>Khi mÃ£ lá»‡nh vÃ  static data Ä‘Ã£ Ä‘Æ°á»£c load vÃ o bá»™ nhá»›, há»‡ Ä‘iá»u hÃ nh cÃ²n pháº£i lÃ m thÃªm má»™t sá»‘ viá»‡c trÆ°á»›c khi process cÃ³ thá»ƒ cháº¡y:</p>
<ul>
<li><strong>Cáº¥p phÃ¡t bá»™ nhá»› cho ngÄƒn xáº¿p (stack):</strong> CÃ¡c chÆ°Æ¡ng trÃ¬nh C sá»­ dá»¥ng stack Ä‘á»ƒ lÆ°u biáº¿n cá»¥c bá»™, tham sá»‘ hÃ m vÃ  Ä‘á»‹a chá»‰ tráº£ vá». Há»‡ Ä‘iá»u hÃ nh sáº½ cáº¥p phÃ¡t vÃ¹ng nhá»› nÃ y vÃ  gÃ¡n nÃ³ cho process. NgoÃ i ra, nÃ³ cÃ²n khá»Ÿi táº¡o stack vá»›i tham sá»‘ Ä‘áº§u vÃ o, cá»¥ thá»ƒ lÃ  cÃ¡c giÃ¡ trá»‹ truyá»n cho hÃ m <code>main()</code>, tá»©c lÃ  <code>argc</code> vÃ  máº£ng <code>argv</code>.</li>
<li><strong>Cáº¥p phÃ¡t bá»™ nhá»› cho heap:</strong> Trong C, heap Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u Ä‘Æ°á»£c cáº¥p phÃ¡t Ä‘á»™ng (dynamic memory). ChÆ°Æ¡ng trÃ¬nh yÃªu cáº§u vÃ¹ng nhá»› nÃ y thÃ´ng qua lá»i gá»i <code>malloc()</code>, vÃ  giáº£i phÃ³ng nÃ³ báº±ng <code>free()</code>. Heap thÆ°á»ng nhá» ban Ä‘áº§u, nhÆ°ng cÃ³ thá»ƒ má»Ÿ rá»™ng khi chÆ°Æ¡ng trÃ¬nh cháº¡y vÃ  yÃªu cáº§u thÃªm bá»™ nhá»›; lÃºc Ä‘Ã³ há»‡ Ä‘iá»u hÃ nh cÃ³ thá»ƒ cáº¥p thÃªm. Heap thÆ°á»ng dÃ¹ng cho cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u phá»©c táº¡p nhÆ° danh sÃ¡ch liÃªn káº¿t, báº£ng bÄƒm, cÃ¢y, v.v.</li>
<li><strong>Khá»Ÿi táº¡o I/O:</strong> VÃ­ dá»¥, trong cÃ¡c há»‡ thá»‘ng UNIX, má»—i process máº·c Ä‘á»‹nh cÃ³ 3 <em>file descriptor</em> (bá»™ mÃ´ táº£ tá»‡p) má»Ÿ sáºµn: chuáº©n nháº­p (stdin), chuáº©n xuáº¥t (stdout), vÃ  chuáº©n lá»—i (stderr). Nhá» Ä‘Ã³, chÆ°Æ¡ng trÃ¬nh cÃ³ thá»ƒ dá»… dÃ ng Ä‘á»c dá»¯ liá»‡u tá»« terminal vÃ  in káº¿t quáº£ ra mÃ n hÃ¬nh.</li>
</ul>
<p>Sau khi load mÃ£ lá»‡nh vÃ  static data, táº¡o stack, chuáº©n bá»‹ heap, vÃ  thiáº¿t láº­p I/O, há»‡ Ä‘iá»u hÃ nh Ä‘Ã£ sáºµn sÃ ng Ä‘á»ƒ process báº¯t Ä‘áº§u excecute. BÆ°á»›c cuá»‘i cÃ¹ng lÃ  chuyá»ƒn quyá»n Ä‘iá»u khiá»ƒn CPU sang chÆ°Æ¡ng trÃ¬nh táº¡i Ä‘iá»ƒm vÃ o (entry point), thÆ°á»ng lÃ  hÃ m <code>main()</code>. Báº±ng cÃ¡ch â€œnháº£yâ€ Ä‘áº¿n <code>main()</code> (thÃ´ng qua má»™t cÆ¡ cháº¿ Ä‘áº·c biá»‡t sáº½ Ä‘Æ°á»£c bÃ n trong chÆ°Æ¡ng tiáº¿p theo), há»‡ Ä‘iá»u hÃ nh Ä‘Ã£ chÃ­nh thá»©c khá»Ÿi Ä‘á»™ng process.</p>
<h2 id="44-cÃ¡c-tráº¡ng-thÃ¡i-cá»§a-process"><a class="header" href="#44-cÃ¡c-tráº¡ng-thÃ¡i-cá»§a-process">4.4 CÃ¡c Tráº¡ng ThÃ¡i cá»§a Process</a></h2>
<p>Giá» Ä‘Ã¢y, khi Ä‘Ã£ náº¯m Ä‘Æ°á»£c process lÃ  gÃ¬ vÃ  sÆ¡ bá»™ cÃ¡ch nÃ³ Ä‘Æ°á»£c táº¡o ra, chÃºng ta sáº½ bÃ n vá» cÃ¡c tráº¡ng thÃ¡i mÃ  má»™t process cÃ³ thá»ƒ á»Ÿ táº¡i má»™t thá»i Ä‘iá»ƒm. KhÃ¡i niá»‡m process cÃ³ thá»ƒ tá»“n táº¡i trong nhiá»u tráº¡ng thÃ¡i khÃ¡c nhau báº¯t nguá»“n tá»« cÃ¡c há»‡ thá»‘ng mÃ¡y tÃ­nh Ä‘á»i Ä‘áº§u [DV66, V+65].</p>
<p>Trong má»™t mÃ´ hÃ¬nh Ä‘Æ¡n giáº£n, process cÃ³ thá»ƒ á»Ÿ má»™t trong ba tráº¡ng thÃ¡i:</p>
<ul>
<li><strong>Running (Äang cháº¡y):</strong> Process Ä‘ang thá»±c sá»± cháº¡y trÃªn CPU, nghÄ©a lÃ  nÃ³ Ä‘ang excecute cÃ¡c chá»‰ thá»‹.</li>
<li><strong>Ready (Sáºµn sÃ ng):</strong> Process Ä‘Ã£ sáºµn sÃ ng cháº¡y, nhÆ°ng vÃ¬ lÃ½ do nÃ o Ä‘Ã³ há»‡ Ä‘iá»u hÃ nh chÆ°a cho nÃ³ chiáº¿m CPU á»Ÿ thá»i Ä‘iá»ƒm hiá»‡n táº¡i.</li>
<li><strong>Blocked (Bá»‹ cháº·n):</strong> Process Ä‘ang chá» má»™t sá»± kiá»‡n khÃ¡c Ä‘á»ƒ cÃ³ thá»ƒ tiáº¿p tá»¥c cháº¡y. VÃ­ dá»¥: khi process gá»­i yÃªu cáº§u I/O Ä‘áº¿n Ä‘Ä©a, nÃ³ sáº½ bá»‹ cháº·n cho Ä‘áº¿n khi thao tÃ¡c Ä‘Ã³ hoÃ n táº¥t, trong khi Ä‘Ã³ CPU cÃ³ thá»ƒ phá»¥c vá»¥ process khÃ¡c.</li>
</ul>
<p><img src="./img/fig4_2.PNG" alt="" /></p>
<p><strong>HÃ¬nh 4.2: CÃ¡c tráº¡ng thÃ¡i cá»§a Process vÃ  sá»± chuyá»ƒn Ä‘á»•i</strong></p>
<p>Trong sÆ¡ Ä‘á»“ tráº¡ng thÃ¡i (HÃ¬nh 4.2), báº¡n cÃ³ thá»ƒ tháº¥y process Ä‘Æ°á»£c chuyá»ƒn qua láº¡i giá»¯a tráº¡ng thÃ¡i <em>ready</em> vÃ  <em>running</em> dÆ°á»›i sá»± Ä‘iá»u phá»‘i cá»§a há»‡ Ä‘iá»u hÃ nh.</p>
<ul>
<li>Tá»« <em>ready â†’ running</em>: process Ä‘Æ°á»£c <strong>schedule</strong> (láº­p lá»‹ch Ä‘á»ƒ cháº¡y).</li>
<li>Tá»« <em>running â†’ ready</em>: process bá»‹ <strong>deschedule</strong> (dá»«ng cháº¡y).</li>
<li>Khi process chuyá»ƒn sang <em>blocked</em>, há»‡ Ä‘iá»u hÃ nh sáº½ giá»¯ nÃ³ trong tráº¡ng thÃ¡i nÃ y cho Ä‘áº¿n khi sá»± kiá»‡n cáº§n thiáº¿t xáº£y ra (vÃ­ dá»¥: I/O hoÃ n táº¥t), sau Ä‘Ã³ chuyá»ƒn nÃ³ vá» tráº¡ng thÃ¡i <em>ready</em> (vÃ  cÃ³ thá»ƒ láº­p lá»‹ch cháº¡y ngay).</li>
</ul>
<p>VÃ­ dá»¥: giáº£ sá»­ cÃ³ hai process cháº¡y, cáº£ hai chá»‰ dÃ¹ng CPU (khÃ´ng I/O). Dáº¥u váº¿t tráº¡ng thÃ¡i (trace) cá»§a chÃºng sáº½ giá»‘ng nhÆ° HÃ¬nh 4.3.</p>
<p><img src="./img/fig4_3.PNG" alt="" /></p>
<p><strong>HÃ¬nh 4.3: Dáº¥u váº¿t tráº¡ng thÃ¡i process â€“ chá»‰ dÃ¹ng CPU</strong></p>
<p>Trong vÃ­ dá»¥ tiáº¿p theo, má»™t process thá»±c hiá»‡n I/O sau má»™t thá»i gian cháº¡y. Khi Ä‘Ã³ nÃ³ chuyá»ƒn sang tráº¡ng thÃ¡i <em>blocked</em>, nhÆ°á»ng CPU cho process cÃ²n láº¡i. Dáº¥u váº¿t tÃ¬nh huá»‘ng nÃ y Ä‘Æ°á»£c thá»ƒ hiá»‡n á»Ÿ HÃ¬nh 4.4.</p>
<p><img src="./img/fig4_4.PNG" alt="" /></p>
<p><strong>HÃ¬nh 4.4: Dáº¥u váº¿t tráº¡ng thÃ¡i process â€“ CPU vÃ  I/O</strong></p>
<p>Cá»¥ thá»ƒ, Process0 thá»±c hiá»‡n má»™t yÃªu cáº§u I/O vÃ  bá»‹ cháº·n Ä‘á»ƒ chá» káº¿t quáº£; Ä‘iá»u nÃ y thÆ°á»ng xáº£y ra khi Ä‘á»c tá»« Ä‘Ä©a hoáº·c chá» gÃ³i tin máº¡ng. Há»‡ Ä‘iá»u hÃ nh nháº­n tháº¥y Process0 khÃ´ng dÃ¹ng CPU, nÃªn láº­p lá»‹ch cháº¡y Process1. Trong khi Process1 cháº¡y, I/O hoÃ n táº¥t, Process0 chuyá»ƒn vá» tráº¡ng thÃ¡i <em>ready</em>. Khi Process1 káº¿t thÃºc, Process0 Ä‘Æ°á»£c cháº¡y tiáº¿p cho Ä‘áº¿n khi hoÃ n thÃ nh.</p>
<p><strong>LÆ°u Ã½</strong>: ngay cáº£ trong vÃ­ dá»¥ Ä‘Æ¡n giáº£n nÃ y, há»‡ Ä‘iá»u hÃ nh váº«n pháº£i Ä‘Æ°a ra nhiá»u quyáº¿t Ä‘á»‹nh. Thá»© nháº¥t, há»‡ thá»‘ng chá»n cháº¡y Process1 trong khi Process0 bá»‹ cháº·n I/O â€“ Ä‘iá»u nÃ y giÃºp táº­n dá»¥ng CPU tá»‘t hÆ¡n. Thá»© hai, khi I/O cá»§a Process0 hoÃ n táº¥t, há»‡ Ä‘iá»u hÃ nh <strong>khÃ´ng láº­p tá»©c chuyá»ƒn láº¡i cho Process0</strong> mÃ  Ä‘á»ƒ Process1 tiáº¿p tá»¥c. ÄÃ¢y cÃ³ pháº£i lÃ  quyáº¿t Ä‘á»‹nh Ä‘Ãºng hay khÃ´ng? Nhá»¯ng quyáº¿t Ä‘á»‹nh nhÆ° váº­y Ä‘Æ°á»£c Ä‘Æ°a ra bá»Ÿi <strong>OS scheduler (bá»™ láº­p lá»‹ch cá»§a há»‡ Ä‘iá»u hÃ nh)</strong> â€“ chá»§ Ä‘á» chÃºng ta sáº½ bÃ n ká»¹ hÆ¡n trong cÃ¡c chÆ°Æ¡ng tá»›i.</p>
<h2 id="45-cáº¥u-trÃºc-dá»¯-liá»‡u"><a class="header" href="#45-cáº¥u-trÃºc-dá»¯-liá»‡u">4.5 Cáº¥u TrÃºc Dá»¯ Liá»‡u</a></h2>
<p>Há»‡ Ä‘iá»u hÃ nh cÅ©ng chá»‰ lÃ  má»™t chÆ°Æ¡ng trÃ¬nh, vÃ  giá»‘ng nhÆ° má»i chÆ°Æ¡ng trÃ¬nh khÃ¡c, nÃ³ sá»­ dá»¥ng cÃ¡c <strong>cáº¥u trÃºc dá»¯ liá»‡u</strong> Ä‘á»ƒ quáº£n lÃ½ thÃ´ng tin.</p>
<p>VÃ­ dá»¥: Ä‘á»ƒ theo dÃµi tráº¡ng thÃ¡i cá»§a cÃ¡c process, há»‡ Ä‘iá»u hÃ nh thÆ°á»ng duy trÃ¬ má»™t <strong>danh sÃ¡ch process</strong> (process list) chá»©a táº¥t cáº£ process Ä‘ang á»Ÿ tráº¡ng thÃ¡i <em>ready</em>, kÃ¨m thÃªm thÃ´ng tin vá» process hiá»‡n táº¡i Ä‘ang cháº¡y. Há»‡ Ä‘iá»u hÃ nh cÅ©ng cáº§n quáº£n lÃ½ danh sÃ¡ch cÃ¡c process <em>blocked</em>; khi má»™t sá»± kiá»‡n I/O hoÃ n táº¥t, OS pháº£i Ä‘Ã¡nh thá»©c Ä‘Ãºng process liÃªn quan vÃ  chuyá»ƒn nÃ³ sang tráº¡ng thÃ¡i <em>ready</em>.</p>
<p>HÃ¬nh 4.5 thá»ƒ hiá»‡n ThÃ´ng tin OS theo dÃµi cho má»—i process trong nhÃ¢n xv6 [CK+08]. Trong cÃ¡c há»‡ Ä‘iá»u hÃ nh thá»±c táº¿ nhÆ° Linux, Mac OS X, hay Windows, cáº¥u trÃºc quáº£n lÃ½ process cÃ²n phá»©c táº¡p hÆ¡n nhiá»u. Báº¡n cÃ³ thá»ƒ tá»± tÃ¬m hiá»ƒu Ä‘á»ƒ so sÃ¡nh má»©c Ä‘á»™ chi tiáº¿t.</p>
<p>Trong hÃ¬nh, ta tháº¥y má»™t sá»‘ thÃ´ng tin quan trá»ng mÃ  há»‡ Ä‘iá»u hÃ nh lÆ°u cho má»—i process. <strong>Register context (Ngá»¯ cáº£nh thanh ghi):</strong> Äá»‘i vá»›i process bá»‹ dá»«ng, há»‡ Ä‘iá»u hÃ nh lÆ°u láº¡i toÃ n bá»™ giÃ¡ trá»‹ cÃ¡c thanh ghi vÃ o vÃ¹ng nhá»› nÃ y. Khi cáº§n cháº¡y láº¡i process, OS chá»‰ viá»‡c khÃ´i phá»¥c cÃ¡c giÃ¡ trá»‹ vÃ o thanh ghi váº­t lÃ½ Ä‘á»ƒ tiáº¿p tá»¥c excecute. Ká»¹ thuáº­t nÃ y gá»i lÃ  <strong>context switch (chuyá»ƒn ngá»¯ cáº£nh)</strong> â€“ sáº½ Ä‘Æ°á»£c bÃ n ká»¹ trong cÃ¡c chÆ°Æ¡ng tiáº¿p theo.</p>
<pre><code class="language-c">// the registers xv6 will save and restore
// to stop and subsequently restart a process
struct context {
  int eip;
  int esp;
  int ebx;
  int ecx;
  int edx;
  int esi;
  int edi;
  int ebp;
};
// the different states a process can be in
enum proc_state {
  UNUSED,
  EMBRYO,
  SLEEPING,
  RUNNABLE,
  RUNNING,
  ZOMBIE
};
// the information xv6 tracks about each process
// including its register context and state
struct proc {
  char * mem;
  // Start of process memory
  uint sz;
  // Size of process memory
  char * kstack;
  // Bottom of kernel stack
  // for this process
  enum proc_state state; // Process state
  int pid;
  // Process ID
  struct proc * parent;
  // Parent process
  void * chan;
  // If !zero, sleeping on chan
  int killed;
  // If !zero, has been killed
  struct file * ofile[NOFILE]; // Open files
  struct inode * cwd;
  // Current directory
  struct context context; // Switch here to run process
  struct trapframe * tf;
  // Trap frame for the
  // current interrupt
};
</code></pre>
<p>Báº¡n cÅ©ng cÃ³ thá»ƒ tháº¥y tá»« hÃ¬nh minh há»a ráº±ng má»™t process (process) cÃ³ thá»ƒ á»Ÿ má»™t sá»‘ tráº¡ng thÃ¡i khÃ¡c ngoÃ i Ä‘ang cháº¡y (running), sáºµn sÃ ng (ready), vÃ  bá»‹ cháº·n (blocked). ÄÃ´i khi má»™t há»‡ thá»‘ng sáº½ cÃ³ má»™t tráº¡ng thÃ¡i ban Ä‘áº§u (initial state) mÃ  process á»Ÿ trong Ä‘Ã³ khi nÃ³ Ä‘ang Ä‘Æ°á»£c táº¡o ra. NgoÃ i ra, má»™t process cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘áº·t vÃ o má»™t tráº¡ng thÃ¡i cuá»‘i (final state), nÆ¡i nÃ³ Ä‘Ã£ thoÃ¡t ra nhÆ°ng chÆ°a Ä‘Æ°á»£c dá»n dáº¹p (trong cÃ¡c há»‡ thá»‘ng dá»±a trÃªn UNIX, tráº¡ng thÃ¡i nÃ y Ä‘Æ°á»£c gá»i lÃ  <strong>tráº¡ng thÃ¡i zombie</strong> (thÃ¢y ma)Â¹).</p>
<p><em>(Giáº£i thÃ­ch: Tráº¡ng thÃ¡i nÃ y Ä‘Æ°á»£c gá»i lÃ  &quot;zombie&quot; vÃ¬ process Ä‘Ã£ &quot;cháº¿t&quot; - tá»©c lÃ  Ä‘Ã£ káº¿t thÃºc excecute - nhÆ°ng thÃ´ng tin vá» nÃ³ váº«n cÃ²n tá»“n táº¡i trong báº£ng process, chÆ°a Ä‘Æ°á»£c &quot;chÃ´n cáº¥t&quot; hay dá»n dáº¹p hoÃ n toÃ n.)</em></p>
<p>Tráº¡ng thÃ¡i cuá»‘i nÃ y cÃ³ thá»ƒ há»¯u Ã­ch vÃ¬ nÃ³ cho phÃ©p cÃ¡c process khÃ¡c (thÆ°á»ng lÃ  process cha Ä‘Ã£ táº¡o ra process nÃ y) kiá»ƒm tra mÃ£ tráº£ vá» (return code) cá»§a process vÃ  xem liá»‡u process vá»«a hoÃ n thÃ nh cÃ³ excecute thÃ nh cÃ´ng hay khÃ´ng (thÆ°á»ng thÃ¬ cÃ¡c chÆ°Æ¡ng trÃ¬nh trong há»‡ thá»‘ng dá»±a trÃªn UNIX tráº£ vá» giÃ¡ trá»‹ 0 khi chÃºng Ä‘Ã£ hoÃ n thÃ nh tÃ¡c vá»¥ thÃ nh cÃ´ng, vÃ  khÃ¡c 0 trong trÆ°á»ng há»£p ngÆ°á»£c láº¡i). Khi xong viá»‡c, process cha sáº½ thá»±c hiá»‡n má»™t lá»i gá»i cuá»‘i cÃ¹ng (vÃ­ dá»¥, <code>wait()</code>) Ä‘á»ƒ chá» Ä‘á»£i sá»± hoÃ n thÃ nh cá»§a process con, vÃ  cÅ©ng Ä‘á»ƒ bÃ¡o cho OS ráº±ng nÃ³ cÃ³ thá»ƒ dá»n dáº¹p báº¥t ká»³ cáº¥u trÃºc dá»¯ liá»‡u nÃ o liÃªn quan Ä‘áº¿n process Ä‘Ã£ khÃ´ng cÃ²n tá»“n táº¡i nÃ y.</p>
<blockquote>
<p><strong>Táº¢N Máº N: Cáº¤U TRÃšC Dá»® LIá»†U â€” DANH SÃCH TIáº¾N TRÃŒNH</strong></p>
<p>CÃ¡c há»‡ Ä‘iá»u hÃ nh chá»©a Ä‘áº§y Ä‘á»§ cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u quan trá»ng khÃ¡c nhau mÃ  chÃºng ta sáº½ tháº£o luáº­n trong tÃ i liá»‡u nÃ y. <strong>Danh sÃ¡ch process</strong> (Process List), cÃ²n Ä‘Æ°á»£c gá»i lÃ  danh sÃ¡ch tÃ¡c vá»¥ (task list), lÃ  cáº¥u trÃºc Ä‘áº§u tiÃªn nhÆ° váº­y. NÃ³ lÃ  má»™t trong nhá»¯ng cáº¥u trÃºc Ä‘Æ¡n giáº£n hÆ¡n, nhÆ°ng cháº¯c cháº¯n báº¥t ká»³ há»‡ Ä‘iá»u hÃ nh nÃ o cÃ³ kháº£ nÄƒng cháº¡y nhiá»u chÆ°Æ¡ng trÃ¬nh cÃ¹ng má»™t lÃºc sáº½ cÃ³ má»™t thá»© gÃ¬ Ä‘Ã³ tÆ°Æ¡ng tá»± nhÆ° cáº¥u trÃºc nÃ y Ä‘á»ƒ theo dÃµi táº¥t cáº£ cÃ¡c chÆ°Æ¡ng trÃ¬nh Ä‘ang cháº¡y trong há»‡ thá»‘ng. ÄÃ´i khi ngÆ°á»i ta gá»i cáº¥u trÃºc riÃªng láº» lÆ°u trá»¯ thÃ´ng tin vá» má»™t process lÃ  <strong>Khá»‘i Quáº£n lÃ½ Process</strong> (Process Control Block - PCB), má»™t cÃ¡ch nÃ³i hoa má»¹ Ä‘á»ƒ chá»‰ má»™t cáº¥u trÃºc trong ngÃ´n ngá»¯ C chá»©a thÃ´ng tin vá» má»—i process (Ä‘Ã´i khi cÃ²n Ä‘Æ°á»£c gá»i lÃ  bá»™ mÃ´ táº£ process - process descriptor).</p>
</blockquote>
<h2 id="46-tÃ³m-táº¯t"><a class="header" href="#46-tÃ³m-táº¯t">4.6 TÃ³m táº¯t</a></h2>
<p>ChÃºng ta Ä‘Ã£ giá»›i thiá»‡u khÃ¡i niá»‡m trá»«u tÆ°á»£ng hÃ³a cÆ¡ báº£n nháº¥t cá»§a OS: process. NÃ³ Ä‘Æ°á»£c xem má»™t cÃ¡ch khÃ¡ Ä‘Æ¡n giáº£n lÃ  má»™t chÆ°Æ¡ng trÃ¬nh Ä‘ang cháº¡y. Vá»›i quan Ä‘iá»ƒm khÃ¡i niá»‡m nÃ y, bÃ¢y giá» chÃºng ta sáº½ chuyá»ƒn sang cÃ¡c chi tiáº¿t cá»‘t lÃµi: cÃ¡c cÆ¡ cháº¿ cáº¥p tháº¥p cáº§n thiáº¿t Ä‘á»ƒ triá»ƒn khai process, vÃ  cÃ¡c policy cáº¥p cao cáº§n thiáº¿t Ä‘á»ƒ láº­p lá»‹ch (schedule) cho chÃºng má»™t cÃ¡ch thÃ´ng minh. Báº±ng cÃ¡ch káº¿t há»£p cÃ¡c cÆ¡ cháº¿ vÃ  policy, chÃºng ta sáº½ xÃ¢y dá»±ng sá»± hiá»ƒu biáº¿t cá»§a mÃ¬nh vá» cÃ¡ch má»™t há»‡ Ä‘iá»u hÃ nh áº£o hÃ³a CPU.</p>
<blockquote>
<p><strong>Táº¢N Máº N: CÃC THUáº¬T NGá»® CHÃNH Vá»€ TIáº¾N TRÃŒNH</strong></p>
<ul>
<li><strong>Tiáº¿n trÃ¬nh (process)</strong> lÃ  khÃ¡i niá»‡m trá»«u tÆ°á»£ng hÃ³a chÃ­nh cá»§a há»‡ Ä‘iá»u hÃ nh vá» má»™t chÆ°Æ¡ng trÃ¬nh Ä‘ang cháº¡y. Táº¡i báº¥t ká»³ thá»i Ä‘iá»ƒm nÃ o, process cÃ³ thá»ƒ Ä‘Æ°á»£c mÃ´ táº£ bá»Ÿi tráº¡ng thÃ¡i cá»§a nÃ³: ná»™i dung bá»™ nhá»› trong khÃ´ng gian Ä‘á»‹a chá»‰ (address space) cá»§a nÃ³, ná»™i dung cá»§a cÃ¡c thanh ghi CPU (bao gá»“m bá»™ Ä‘áº¿m chÆ°Æ¡ng trÃ¬nh - program counter vÃ  con trá» ngÄƒn xáº¿p - stack pointer, cÃ¹ng nhiá»u thanh ghi khÃ¡c), vÃ  thÃ´ng tin vá» I/O (cháº³ng háº¡n nhÆ° cÃ¡c táº­p tin Ä‘ang má»Ÿ cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘á»c hoáº·c ghi).</li>
<li><strong>API process</strong> bao gá»“m cÃ¡c lá»i gá»i mÃ  chÆ°Æ¡ng trÃ¬nh cÃ³ thá»ƒ thá»±c hiá»‡n liÃªn quan Ä‘áº¿n process. ThÃ´ng thÆ°á»ng, Ä‘iá»u nÃ y bao gá»“m viá»‡c táº¡o (creation), há»§y (destruction), vÃ  cÃ¡c lá»i gá»i há»¯u Ã­ch khÃ¡c.</li>
<li>CÃ¡c process tá»“n táº¡i á»Ÿ má»™t trong nhiá»u <strong>tráº¡ng thÃ¡i process</strong> khÃ¡c nhau, bao gá»“m <strong>Ä‘ang cháº¡y (running)</strong>, <strong>sáºµn sÃ ng cháº¡y (ready to run)</strong>, vÃ  <strong>bá»‹ cháº·n (blocked)</strong>. CÃ¡c sá»± kiá»‡n khÃ¡c nhau (vÃ­ dá»¥: Ä‘Æ°á»£c láº­p lá»‹ch Ä‘á»ƒ cháº¡y hoáº·c bá»‹ rÃºt khá»i CPU, hoáº·c chá» má»™t thao tÃ¡c I/O hoÃ n táº¥t) sáº½ chuyá»ƒn má»™t process tá»« tráº¡ng thÃ¡i nÃ y sang tráº¡ng thÃ¡i khÃ¡c.</li>
<li>Má»™t <strong>danh sÃ¡ch process (process list)</strong> chá»©a thÃ´ng tin vá» táº¥t cáº£ cÃ¡c process trong há»‡ thá»‘ng. Má»—i má»¥c nháº­p Ä‘Æ°á»£c tÃ¬m tháº¥y trong má»™t cáº¥u trÃºc Ä‘Ã´i khi Ä‘Æ°á»£c gá»i lÃ  <strong>khá»‘i quáº£n lÃ½ process (process control block - PCB)</strong>, thá»±c cháº¥t chá»‰ lÃ  má»™t cáº¥u trÃºc chá»©a thÃ´ng tin vá» má»™t process cá»¥ thá»ƒ.</li>
</ul>
</blockquote>
<h2 id="tham-kháº£o"><a class="header" href="#tham-kháº£o">Tham kháº£o</a></h2>
<p>[BH70] â€œThe Nucleus of a Multiprogramming Systemâ€<br />
Per Brinch Hansen<br />
Communications of the ACM, Volume 13, Number 4, April 1970<br />
This paper introduces one of the first microkernels in operating systems history, called Nucleus. The idea of smaller, more minimal systems is a theme that rears its head repeatedly in OS history; it all began with Brinch Hansenâ€™s work described herein.</p>
<p>[CK+08] â€œThe xv6 Operating Systemâ€<br />
Russ Cox, Frans Kaashoek, Robert Morris, Nickolai Zeldovich<br />
From: https://github.com/mit-pdos/xv6-public<br />
The coolest real and little OS in the world. Download and play with it to learn more about the details of how operating systems actually work. We have been using an older version (2012-01-30-1-g1c41342) and hence some examples in the book may not match the latest in the source.</p>
<p>[DV66] â€œProgramming Semantics for Multiprogrammed Computationsâ€<br />
Jack B. Dennis and Earl C. Van Horn<br />
Communications of the ACM, Volume 9, Number 3, March 1966<br />
This paper defined many of the early terms and concepts around building multiprogrammed systems.</p>
<p>[L+75] â€œPolicy/mechanism separation in Hydraâ€<br />
R. Levin, E. Cohen, W. Corwin, F. Pollack, W. Wulf<br />
SOSP 1975<br />
An early paper about how to structure operating systems in a research OS known as Hydra. While Hydra never became a mainstream OS, some of its ideas influenced OS designers.</p>
<p>[V+65] â€œStructure of the Multics Supervisorâ€<br />
V.A. Vyssotsky, F. J. Corbato, R. M. Graham<br />
Fall Joint Computer Conference, 1965<br />
An early paper on Multics, which described many of the basic ideas and terms that we find in modern systems. Some of the vision behind computing as a utility are finally being realized in modern cloud systems.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../03/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../05/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../03/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../05/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
